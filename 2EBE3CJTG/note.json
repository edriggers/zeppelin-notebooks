{
  "paragraphs": [
    {
      "text": "%md\n\u003clink rel\u003d\"stylesheet\" href\u003d\"https://doc.splicemachine.com/zeppelin/css/zepstyles2.css\" /\u003e\n# Statistics\n\nDatabase statistics are a form of metadata (data about data) that assists the Splice Machine query optimizer; the statistics help the optimizer select the most efficient approach to running a query, based on information that has been gathered about the tables involved in the query.\n",
      "user": "anonymous",
      "dateUpdated": "2019-06-03 20:31:49.686",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003clink rel\u003d\"stylesheet\" href\u003d\"https://doc.splicemachine.com/zeppelin/css/zepstyles2.css\" /\u003e\n\u003ch1\u003eStatistics\u003c/h1\u003e\n\u003cp\u003eDatabase statistics are a form of metadata (data about data) that assists the Splice Machine query optimizer; the statistics help the optimizer select the most efficient approach to running a query, based on information that has been gathered about the tables involved in the query.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1559318715381_-665813334",
      "id": "20190531-160515_1367525291",
      "dateCreated": "2019-05-31 16:05:15.381",
      "dateStarted": "2019-06-03 20:31:49.688",
      "dateFinished": "2019-06-03 20:31:49.726",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n\u003clink rel\u003d\"stylesheet\" href\u003d\"https://doc.splicemachine.com/zeppelin/css/zepstyles2.css\" /\u003e\n# Collecting Statistics\n\nYou can collect statistics on a schema or table using the \"analyze\" command. As a best practice, you should run stastics on a table if an index has been created or if you\u0027ve modified more than 10% of the data. By default, statistics are calculated on all columns of a table. To selectively do it on a column, you can use builtin stored procedure to specify which column is to be used \"SYSCS_UTIL.DISABLE_COLUMN_STATISTICS( schema, table, column)\"\n\nTo view statistics, you can query the  SYSTABLESTATISTICS System View to view statistics for specific tables. OR, query the  SYSCOLUMNSTATISTICS System View to view statistics for specific table columns.\n\nThe analyze command collects statistics for a specific table, or for an entire schema.\n\nThe ANALYZE TABLE command collects statistics for a specific table in the current schema. It also collects statistics for the index associated with the table in the schema.\nThe ANALYZE SCHEMA command collects statistics for every table in the schema. It also collects statistics for the index associated with every table in the schema.\n\nFollowing is how you can interpret the output of analyze command.\n\n\u003ctable summary\u003d\"List of columns in the output of the analyze table command.\"\u003e\n            \u003ccol /\u003e\n            \u003ccol /\u003e\n            \u003cthead\u003e\n                \u003ctr\u003e\n                    \u003cth\u003eValue\u003c/th\u003e\n                    \u003cth\u003eDescription\u003c/th\u003e\n                \u003c/tr\u003e\n            \u003c/thead\u003e\n            \u003ctbody\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003e\u003ccode\u003eschemaName\u003c/code\u003e\u003c/td\u003e\n                    \u003ctd\u003eThe name of the schema.\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003e\u003ccode\u003etableName\u003c/code\u003e\u003c/td\u003e\n                    \u003ctd\u003eThe name of the table.\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003e\u003ccode\u003epartition\u003c/code\u003e\u003c/td\u003e\n                    \u003ctd\u003eThe Splice Machine partition. We merge the statistics for all table partitions, so the partition will show as \u003ccode\u003e-All-\u003c/code\u003e when you specify one of the non-merged type values for the \u003ccode\u003estatsType\u003c/code\u003e parameter.\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003e\u003ccode\u003erowsCollected\u003c/code\u003e\u003c/td\u003e\n                    \u003ctd\u003eThe total number of rows collected for the table.\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003e\u003ccode\u003epartitionSize\u003c/code\u003e\u003c/td\u003e\n                    \u003ctd\u003eThe combined size of the table\u0027s partitions.\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003e\u003ccode\u003estatsType\u003c/code\u003e\u003c/td\u003e\n                    \u003ctd\u003e\u003cp\u003eThe type of statistics, which is one of these values:\u003c/p\u003e\n                        \u003ctable\u003e\n                            \u003ccol /\u003e\n                            \u003ccol /\u003e\n                            \u003ctbody\u003e\n                                \u003ctr\u003e\n                                    \u003ctd\u003e0\u003c/td\u003e\n                                    \u003ctd\u003eFull table (not sampled) statistics that reflect the unmerged partition values.\u003c/td\u003e\n                                \u003c/tr\u003e\n                                \u003ctr\u003e\n                                    \u003ctd\u003e1\u003c/td\u003e\n                                    \u003ctd\u003eSampled statistics that reflect the unmerged partition values.\u003c/td\u003e\n                                \u003c/tr\u003e\n                                \u003ctr\u003e\n                                    \u003ctd\u003e2\u003c/td\u003e\n                                    \u003ctd\u003eFull table (not sampled) statistics that reflect the table values after all partitions have been merged.\u003c/td\u003e\n                                \u003c/tr\u003e\n                                \u003ctr\u003e\n                                    \u003ctd\u003e3\u003c/td\u003e\n                                    \u003ctd\u003eSampled statistics that reflect the table values after all partitions have been merged.\u003c/td\u003e\n                                \u003c/tr\u003e\n                            \u003c/tbody\u003e\n                        \u003c/table\u003e\n                    \u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003e\u003ccode\u003esampleFraction\u003c/code\u003e\u003c/td\u003e\n                    \u003ctd\u003e\n                        \u003cp\u003eThe sampling percentage, expressed as \u003ccode\u003e0.0\u003c/code\u003e to \u003ccode\u003e1.0\u003c/code\u003e, \u003c/p\u003e\n                        \u003cul\u003e\n                            \u003cli\u003eIf \u003ccode\u003estatsType\u003d0\u003c/code\u003e or \u003ccode\u003estatsType\u003d1\u003c/code\u003e (full statistics), this value is not used, and is shown as \u003ccode\u003e0\u003c/code\u003e.\u003c/li\u003e\n                            \u003cli\u003eIf \u003ccode\u003estatsType\u003d2\u003c/code\u003e or \u003ccode\u003estatsType\u003d3\u003c/code\u003e, this value is the percentage or rows to be sampled. A value of \u003ccode\u003e0\u003c/code\u003e means no rows, and a value of \u003ccode\u003e1\u003c/code\u003e means all rows (same as full statistics).\u003c/li\u003e\n                        \u003c/ul\u003e\n                    \u003c/td\u003e\n                \u003c/tr\u003e\n            \u003c/tbody\u003e\n        \u003c/table\u003e",
      "user": "anonymous",
      "dateUpdated": "2019-06-03 20:45:27.766",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003clink rel\u003d\"stylesheet\" href\u003d\"https://doc.splicemachine.com/zeppelin/css/zepstyles2.css\" /\u003e\n\u003ch1\u003eCollecting Statistics\u003c/h1\u003e\n\u003cp\u003eYou can collect statistics on a schema or table using the \u0026ldquo;analyze\u0026rdquo; command. As a best practice, you should run stastics on a table if an index has been created or if you\u0026rsquo;ve modified more than 10% of the data. By default, statistics are calculated on all columns of a table. To selectively do it on a column, you can use builtin stored procedure to specify which column is to be used \u0026ldquo;SYSCS_UTIL.DISABLE_COLUMN_STATISTICS( schema, table, column)\u0026rdquo;\u003c/p\u003e\n\u003cp\u003eTo view statistics, you can query the SYSTABLESTATISTICS System View to view statistics for specific tables. OR, query the SYSCOLUMNSTATISTICS System View to view statistics for specific table columns.\u003c/p\u003e\n\u003cp\u003eThe analyze command collects statistics for a specific table, or for an entire schema.\u003c/p\u003e\n\u003cp\u003eThe ANALYZE TABLE command collects statistics for a specific table in the current schema. It also collects statistics for the index associated with the table in the schema.\u003cbr/\u003eThe ANALYZE SCHEMA command collects statistics for every table in the schema. It also collects statistics for the index associated with every table in the schema.\u003c/p\u003e\n\u003cp\u003eFollowing is how you can interpret the output of analyze command.\u003c/p\u003e\n\u003ctable summary\u003d\"List of columns in the output of the analyze table command.\"\u003e\n            \u003ccol /\u003e\n            \u003ccol /\u003e\n            \u003cthead\u003e\n                \u003ctr\u003e\n                    \u003cth\u003eValue\u003c/th\u003e\n                    \u003cth\u003eDescription\u003c/th\u003e\n                \u003c/tr\u003e\n            \u003c/thead\u003e\n            \u003ctbody\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003e\u003ccode\u003eschemaName\u003c/code\u003e\u003c/td\u003e\n                    \u003ctd\u003eThe name of the schema.\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003e\u003ccode\u003etableName\u003c/code\u003e\u003c/td\u003e\n                    \u003ctd\u003eThe name of the table.\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003e\u003ccode\u003epartition\u003c/code\u003e\u003c/td\u003e\n                    \u003ctd\u003eThe Splice Machine partition. We merge the statistics for all table partitions, so the partition will show as \u003ccode\u003e-All-\u003c/code\u003e when you specify one of the non-merged type values for the \u003ccode\u003estatsType\u003c/code\u003e parameter.\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003e\u003ccode\u003erowsCollected\u003c/code\u003e\u003c/td\u003e\n                    \u003ctd\u003eThe total number of rows collected for the table.\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003e\u003ccode\u003epartitionSize\u003c/code\u003e\u003c/td\u003e\n                    \u003ctd\u003eThe combined size of the table\u0027s partitions.\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003e\u003ccode\u003estatsType\u003c/code\u003e\u003c/td\u003e\n                    \u003ctd\u003e\u003cp\u003eThe type of statistics, which is one of these values:\u003c/p\u003e\n                        \u003ctable\u003e\n                            \u003ccol /\u003e\n                            \u003ccol /\u003e\n                            \u003ctbody\u003e\n                                \u003ctr\u003e\n                                    \u003ctd\u003e0\u003c/td\u003e\n                                    \u003ctd\u003eFull table (not sampled) statistics that reflect the unmerged partition values.\u003c/td\u003e\n                                \u003c/tr\u003e\n                                \u003ctr\u003e\n                                    \u003ctd\u003e1\u003c/td\u003e\n                                    \u003ctd\u003eSampled statistics that reflect the unmerged partition values.\u003c/td\u003e\n                                \u003c/tr\u003e\n                                \u003ctr\u003e\n                                    \u003ctd\u003e2\u003c/td\u003e\n                                    \u003ctd\u003eFull table (not sampled) statistics that reflect the table values after all partitions have been merged.\u003c/td\u003e\n                                \u003c/tr\u003e\n                                \u003ctr\u003e\n                                    \u003ctd\u003e3\u003c/td\u003e\n                                    \u003ctd\u003eSampled statistics that reflect the table values after all partitions have been merged.\u003c/td\u003e\n                                \u003c/tr\u003e\n                            \u003c/tbody\u003e\n                        \u003c/table\u003e\n                    \u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003e\u003ccode\u003esampleFraction\u003c/code\u003e\u003c/td\u003e\n                    \u003ctd\u003e\n                        \u003cp\u003eThe sampling percentage, expressed as \u003ccode\u003e0.0\u003c/code\u003e to \u003ccode\u003e1.0\u003c/code\u003e, \u003c/p\u003e\n                        \u003cul\u003e\n                            \u003cli\u003eIf \u003ccode\u003estatsType\u003d0\u003c/code\u003e or \u003ccode\u003estatsType\u003d1\u003c/code\u003e (full statistics), this value is not used, and is shown as \u003ccode\u003e0\u003c/code\u003e.\u003c/li\u003e\n                            \u003cli\u003eIf \u003ccode\u003estatsType\u003d2\u003c/code\u003e or \u003ccode\u003estatsType\u003d3\u003c/code\u003e, this value is the percentage or rows to be sampled. A value of \u003ccode\u003e0\u003c/code\u003e means no rows, and a value of \u003ccode\u003e1\u003c/code\u003e means all rows (same as full statistics).\u003c/li\u003e\n                        \u003c/ul\u003e\n                    \u003c/td\u003e\n                \u003c/tr\u003e\n            \u003c/tbody\u003e\n        \u003c/table\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1559593914748_-780537809",
      "id": "20190603-203154_698454412",
      "dateCreated": "2019-06-03 20:31:54.748",
      "dateStarted": "2019-06-03 20:45:27.766",
      "dateFinished": "2019-06-03 20:45:27.794",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%splicemachine\n\ncreate schema test;\nset schema test;\n\ncreate table index_example (i int primary key, j int);\ninsert into index_example values (1,1),(2,2),(3,3),(4,4),(5,5),(6,6),(7,7),(8,8),(9,9),(10,10);\ninsert into index_example select i+10,j+10 from index_example;\ninsert into index_example select i+20,j+20 from index_example;\ninsert into index_example select i+40,j+40 from index_example;\ninsert into index_example select i+80,j+80 from index_example;\ninsert into index_example select i+160,j+160 from index_example;\ninsert into index_example select i+320,j+320 from index_example;\ninsert into index_example select i+640,j+640 from index_example;\ninsert into index_example select i+1280,j+1280 from index_example;\ninsert into index_example select i+2560,j+2560 from index_example;\ninsert into index_example select i+6000,j+6000 from index_example;\ninsert into index_example select i+12000,j+12000 from index_example;\ninsert into index_example select i+24000,j+24000 from index_example;\ninsert into index_example select i+48000,j+48000 from index_example;\ninsert into index_example select i+96000,j+96000 from index_example;\ninsert into index_example select i+200000,j+200000 from index_example;\ninsert into index_example select i+400000,j+400000 from index_example;\ninsert into index_example select i+800000,j+800000 from index_example;\n\nanalyze table test.index_example;",
      "user": "anonymous",
      "dateUpdated": "2019-06-03 20:23:34.889",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "1": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          },
          "21": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "schemaName": "string",
                      "tableName": "string",
                      "partition": "string",
                      "rowsCollected": "string",
                      "partitionSize": "string",
                      "partitionCount": "string",
                      "statsType": "string",
                      "sampleFraction": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionSupport": false
        },
        "editorMode": "ace/mode/sql",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 0"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 0"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 0"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 10"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 10"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 20"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 40"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 80"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 160"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 320"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 640"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 1280"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 2560"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 5120"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 10240"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 20480"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 40960"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 81920"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 163840"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 327680"
          },
          {
            "type": "TEXT",
            "data": "Query executed successfully. Affected rows : 655360"
          },
          {
            "type": "TABLE",
            "data": "schemaName\ttableName\tpartition\trowsCollected\tpartitionSize\tpartitionCount\tstatsType\tsampleFraction\nTEST\tINDEX_EXAMPLE\t-All-\t1310720\t10485760\t1\t2\t0.0\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1559324454407_397844553",
      "id": "20190531-174054_903385761",
      "dateCreated": "2019-05-31 17:40:54.407",
      "dateStarted": "2019-06-03 20:22:29.525",
      "dateFinished": "2019-06-03 20:23:32.242",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Where to Go Next\nLets do some exercise of using the analyze command.\n\n1. Create a table with some data just like above example.\n2. Do an explain plan on a sample select query. Notice the discrepancy with row counts etc in explain output.\n3. Run analyze on the table\n4. Run explain plan again and verify that explain picked up the correct statistics.\n",
      "user": "anonymous",
      "dateUpdated": "2019-06-03 20:49:55.830",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eWhere to Go Next\u003c/h2\u003e\n\u003cp\u003eLets do some exercise of using the analyze command.\u003c/p\u003e\n\u003col\u003e\n  \u003cli\u003eCreate a table with some data just like above example.\u003c/li\u003e\n  \u003cli\u003eDo an explain plan on a sample select query. Notice the discrepancy with row counts etc in explain output.\u003c/li\u003e\n  \u003cli\u003eRun analyze on the table\u003c/li\u003e\n  \u003cli\u003eRun explain plan again and verify that explain picked up the correct statistics.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1559324456512_1075891572",
      "id": "20190531-174056_1259339058",
      "dateCreated": "2019-05-31 17:40:56.512",
      "dateStarted": "2019-06-03 20:49:55.831",
      "dateFinished": "2019-06-03 20:49:55.850",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Splice Machine Training /Advanced Developer/c. Statistics",
  "id": "2EBE3CJTG",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "md:shared_process": [],
    "splicemachine:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}