{
  "paragraphs": [
    {
      "text": "%md\n<link rel=\"stylesheet\" href=\"https://doc.splicemachine.com/zeppelin/css/zepstyles2.css\" />\n\n# ETL Pipeline Example\n\nThis notebook presents a simple example of an ETL pipeline. It reads a dataset from a public URL, performs simple data transformations, and inserts data into a Splice Machine database.\n",
      "user": "anonymous",
      "dateUpdated": "2018-12-01 05:44:13.627",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<link rel=\"stylesheet\" href=\"https://doc.splicemachine.com/zeppelin/css/zepstyles2.css\" />\n<h1>ETL Pipeline Example</h1>\n<p>This notebook presents a simple example of an ETL pipeline. It reads a dataset from a public URL, performs simple data transformations, and inserts data into a Splice Machine database.</p>\n</div>"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1542396165231_1238194394",
      "id": "20181116-192245_1346898964",
      "dateCreated": "2018-11-16 11:22:45.000",
      "dateStarted": "2018-11-16 11:25:10.000",
      "dateFinished": "2018-11-16 11:25:10.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\n\nimport org.apache.commons.io.IOUtils\nimport java.net.URL\nimport java.nio.charset.Charset\nimport org.apache.spark.sql.execution.datasources.jdbc.JDBCOptions\nimport com.splicemachine.spark.splicemachine._\n\n// Grab available dataset from Watson\nval telcoText = sc.parallelize(\n    IOUtils.toString(\n        new URL(\"https://community.watsonanalytics.com/wp-content/uploads/2015/03/WA_Fn-UseC_-Telco-Customer-Churn.csv?cm_mc_uid=93701979699314920973859&cm_mc_sid_50200000=1492097385&cm_mc_sid_52640000=1492097385\"),\n        Charset.forName(\"utf8\")).split(\"\\n\"))\n\n// Declare the Schema of the Data Set         \ncase class TelcoChurn (customerID: String, gender: String, SeniorCitizen: Boolean,Partner: String,Dependents: String,tenure: Integer ,PhoneService: String,\nMultipleLines: String,InternetService: String,OnlineSecurity: String,OnlineBackup: String,DeviceProtection: String,TechSupport: String,StreamingTV: String,\nStreamingMovies: String,Contract: String,PaperlessBilling: String,PaymentMethod: String,MonthlyCharges: Double,TotalCharges: Double,Churn: String)\n\n// Perform Data Transformation\nval telcoDF = telcoText.map(s => s.split(\",\")).filter(s => s(0) != \"customerID\").map ( p => TelcoChurn (\n    p(0), p(1), \n    if (p(2).equals(\"0\")) \n        false \n    else \n        true, \n    p(3), p(4), p(5).toInt, p(6), p(7), p(8), p(9), p(10), p(11), p(12), p(13), p(14), p(15), p(16), p(17), p(18).toDouble, p(19).toDouble, p(20))).toDF()\n\n// Show First 10 Values from Data Frame\ntelcoDF.show(10)\n\n// Insert Data Into Database\n",
      "user": "anonymous",
      "dateUpdated": "2018-11-16 11:22:21.000",
      "config": {
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "results": {},
        "enabled": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "fontSize": 9.0
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1542396141142_1804321142",
      "id": "20170413-100458_275811262",
      "dateCreated": "2018-11-16 11:22:21.000",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Where to Go Next\nCongratulations! You've just completed the *Advanced Splice Machine Developer's Class*. \n\nVisit [*Our Training Courses*](/#/notebook/2DWTR5ZBH) notebook learn about our other training classes.\n",
      "user": "anonymous",
      "dateUpdated": "2018-12-01 05:44:35.000",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": false,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorHide": true,
        "editorMode": "ace/mode/markdown",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<h2>Where to Go Next</h2>\n<p>Congratulations! You&rsquo;ve just completed the <em>Advanced Splice Machine Developer&rsquo;s Class</em>. </p>\n<p>Visit <a href=\"/#/notebook/2DWTR5ZBH\"><em>Our Training Courses</em></a> notebook learn about our other training classes.</p>\n</div>"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1542737973060_2140710284",
      "id": "20181120-101933_827290426",
      "dateCreated": "2018-11-20 10:19:33.060",
      "dateStarted": "2018-11-29 18:16:12.651",
      "dateFinished": "2018-11-29 18:16:12.664",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Splice Machine Training/For Developers, Part II - Intermediate/k. ETL Pipeline",
  "id": "2DXK4FQKX",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {}
}